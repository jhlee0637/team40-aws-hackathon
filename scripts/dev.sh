#!/bin/bash

# AWS ë…¸ë“¤ì„¬ í€´ì¦ˆ RPG - ê°œë°œ ìŠ¤í¬ë¦½íŠ¸

echo "ğŸ® AWS ë…¸ë“¤ì„¬ í€´ì¦ˆ RPG ê°œë°œ í™˜ê²½ ì‹œì‘"
echo "=====================================\n"

# 1. ë°ì´í„° ë²ˆë“¤ë§
echo "ğŸ“¦ ë°ì´í„° ë²ˆë“¤ë§ ì¤‘..."
python scripts/bundle-data.py

if [ $? -eq 0 ]; then
    echo "âœ… ë°ì´í„° ë²ˆë“¤ë§ ì™„ë£Œ!\n"
else
    echo "âŒ ë°ì´í„° ë²ˆë“¤ë§ ì‹¤íŒ¨!"
    exit 1
fi

# 2. ì„œë²„ ì‹œì‘
echo "ğŸš€ ë¡œì»¬ ì„œë²„ ì‹œì‘ ì¤‘..."
echo "ë¸Œë¼ìš°ì €ì—ì„œ  ìœ¼ë¡œ ì ‘ì†í•˜ì„¸ìš”\n"
http://localhost:8080
# í¬íŠ¸ 8080ì´ ì‚¬ìš© ì¤‘ì´ë©´ 8081 ì‹œë„
if lsof -Pi :8080 -sTCP:LISTEN -t >/dev/null ; then
    echo "âš ï¸  í¬íŠ¸ 8080ì´ ì‚¬ìš© ì¤‘ì…ë‹ˆë‹¤. í¬íŠ¸ 8081ì„ ì‚¬ìš©í•©ë‹ˆë‹¤."
    python -m http.server 8081
else
    python -m http.server 8080
fi
